<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tu NuevoRestaurante</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Lato:wght@300;400&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --font-serif: 'Playfair Display', serif;
            --font-sans: 'Lato', sans-serif;
            --color-text: #363636;
            --color-title: #bfa98e;
            --color-background: #ffffff;
        }
        body { font-family: var(--font-sans); color: var(--color-text); background-color: var(--color-background); }
        h1, h2, h3 { font-family: var(--font-serif); }
        .main-title { font-family: var(--font-serif); color: var(--color-title); font-size: 4rem; font-weight: 700; letter-spacing: -0.025em; }
        .subtitle { font-family: var(--font-sans); font-weight: 300; font-style: italic; font-size: 1.25rem; margin-bottom: 0.5rem; }
        .banner { height: 60vh; background-size: cover; background-position: center; position: relative; }
        .banner-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; }
        .banner-text { text-align: center; color: white; }
        .banner-text h2 { font-size: 2.5rem; font-weight: bold; margin-bottom: 0.5rem; }
        .banner-text p { font-size: 1.25rem; margin-bottom: 1.5rem; }
        .reservations-button { background-color: var(--color-title); color: white; padding: 0.75rem 1.5rem; border-radius: 9999px; text-decoration: none; font-weight: bold; transition: background-color 0.3s; }
        .reservations-button:hover { background-color: #a89174; }
        .gallery-item-container { cursor: pointer; transition: transform 0.2s; }
        .gallery-item-container:hover { transform: translateY(-8px); }
        .gallery-image { width: 100%; height: 300px; object-fit: cover; border: 8px solid white; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .gallery-title { color: var(--color-text); font-size: 1.75rem; margin-top: 1rem; }
        #admin-fab, #whatsapp-fab { position: fixed; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 1000; transition: all 0.3s; }
        #admin-fab { bottom: 1.5rem; left: 1.5rem; background-color: rgba(54, 54, 54, 0.7); color: white; width: 3rem; height: 3rem; }
        #admin-fab:hover { background-color: rgba(54, 54, 54, 1); }
        #whatsapp-fab { bottom: 1.5rem; right: 1.5rem; background-color: #25D366; color: white; width: 4rem; height: 4rem; }
        #whatsapp-fab:hover { transform: scale(1.1); }
        #modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0, 0, 0, 0.7); z-index: 2000; display: none; align-items: center; justify-content: center; }
        #modal-container { background-color: white; padding: 2rem; border-radius: 0.5rem; width: 90%; max-width: 800px; max-height: 90vh; overflow-y: auto; }
        .admin-label { display: block; font-weight: bold; margin-bottom: 0.5rem; color: #333; }
        .admin-input { width: 100%; padding: 0.75rem; border: 1px solid #ccc; border-radius: 0.25rem; margin-bottom: 1rem; }
        .admin-button { background-color: #333; color: white; padding: 0.75rem 1.5rem; border-radius: 0.25rem; cursor: pointer; transition: background-color 0.3s; }
        .admin-button:hover { background-color: #555; }
        .admin-button-delete { background-color: #ef4444; }
        .admin-button-delete:hover { background-color: #dc2626; }
        .admin-nav-button { background-color: #eee; color: #333; padding: 0.5rem 1rem; border-radius: 0.25rem; border: none; cursor: pointer; }
        .admin-nav-button.active { background-color: var(--color-text); color: white; }
        @media (max-width: 768px) {
            .main-title {
                font-size: 2.5rem;
            }
            .banner-text h2 {
                font-size: 1.75rem;
            }
        }
    </style>
</head>
<body class="bg-white">

    <main id="main-view">
        <header id="banner" class="banner">
            <div class="banner-overlay">
                <div id="banner-text" class="banner-text">
                    <h2 id="banner-title" class="font-serif"></h2>
                    <p id="banner-subtitle"></p>
                    <a href="#" id="banner-button" class="reservations-button"></a>
                </div>
            </div>
        </header>
        <section class="text-center py-16 px-4">
            <p id="main-content-subtitle" class="subtitle"></p>
            <h1 id="main-content-title" class="main-title"></h1>
        </section>
        <section class="container mx-auto px-4 pb-16">
            <div id="gallery" class="grid grid-cols-1 md:grid-cols-3 gap-8"></div>
        </section>
    </main>

    <div id="admin-fab">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
    </div>
    <a id="whatsapp-fab" href="https://wa.me/526645643104" target="_blank" rel="noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" viewBox="0 0 24 24" fill="currentColor"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99 0-3.903-.52-5.586-1.456l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.433-9.89-9.889-9.89-5.452 0-9.887 4.434-9.889 9.891.001 2.23.855 4.34 2.398 5.942l-1.566 5.725 5.853-1.54z" /></svg>
    </a>

    <div id="modal-overlay">
        <div id="modal-container">
            <div id="login-view">
                <h2 class="text-2xl font-bold mb-4">Acceso de Administrador</h2>
                <form id="login-form">
                    <label for="password" class="admin-label">Contraseña</label>
                    <input type="password" id="password" class="admin-input" required>
                    <button type="submit" class="admin-button">Iniciar Sesión</button>
                </form>
                <p id="login-message" class="mt-4 text-red-500"></p>
            </div>
            <div id="admin-panel-view" style="display: none;">
                <div class="flex justify-between items-center mb-6"><h2 class="text-2xl font-bold">Panel de Administración</h2><button id="logout-button" class="admin-button admin-button-delete">Cerrar Sesión</button></div>
                <div class="flex space-x-2 mb-6 border-b pb-4">
                    <button id="admin-nav-site" class="admin-nav-button">Ajustes del Sitio</button>
                    <button id="admin-nav-menus" class="admin-nav-button">Editor de Menús</button>
                </div>
                <div id="admin-site-settings-view">
                    <div class="mb-8 p-4 border rounded"><h3 class="text-xl font-bold mb-4">Editar Banner Principal</h3><form id="banner-form"><label class="admin-label">Título</label><input type="text" name="bannerTitle" class="admin-input"><label class="admin-label">Subtítulo</label><input type="text" name="bannerSubtitle" class="admin-input"><label class="admin-label">Botón</label><input type="text" name="bannerButtonText" class="admin-input"><label class="admin-label">URL de Imagen</label><input type="text" name="bannerImageUrl" class="admin-input"><button type="submit" class="admin-button">Guardar Banner</button></form></div>
                    <div class="mb-8 p-4 border rounded"><h3 class="text-xl font-bold mb-4">Editar Título Principal</h3><form id="main-content-form"><label class="admin-label">Subtítulo</label><input type="text" name="mainContentSubtitle" class="admin-input"><label class="admin-label">Título</label><input type="text" name="mainContentTitle" class="admin-input"><button type="submit" class="admin-button">Guardar Título</button></form></div>
                    <div class="p-4 border rounded"><h3 class="text-xl font-bold mb-4">Editar Galería de Categorías</h3><div id="gallery-forms-container" class="space-y-6"></div><button id="add-gallery-item-button" class="admin-button mt-6">Añadir Categoría</button></div>
                </div>
                <div id="admin-menus-editor-view" style="display: none;">
                    <div class="flex space-x-2 items-center mb-4"><label class="admin-label mb-0">Editando Categoría:</label><select id="menu-category-selector" class="admin-input !w-auto"></select></div>
                    <div class="p-4 border rounded mb-6"><h3 class="text-xl font-bold mb-4">Banner de la Categoría</h3><form id="category-banner-form"><label class="admin-label">URL de Imagen del Banner</label><input type="text" name="bannerImageUrl" class="admin-input"><button type="submit" class="admin-button">Guardar Banner</button></form></div>
                    <div id="menu-editor-items-container" class="space-y-4"></div>
                    <button id="add-menu-item-button" class="admin-button mt-6">Añadir Platillo</button>
                </div>
            </div>
        </div>
    </div>

<script>
const siteData = {
    banner: {
        title: "Una Nueva Historia De Recuerdos llenos de Sabor",
        subtitle: "Ven a la ignauracion este 18 de octubre a las 8:00 pm",
        buttonText: "Reservaciones: 664 554 3104",
        imageUrl: "https://file.garden/Z8NltLNFC1q_3W8R/BannerPrincipal.jpg"
    },
    mainContent: {
        subtitle: "Te esperamos!",
        title: "Descubre el sabor de Tu NuevoRestaurante"
    },
    gallery: [
        { id: 'desayunos', title: 'Desayunos', imageUrl: 'https://images.unsplash.com/photo-1525351484163-7529414344d8?q=80&w=2070&auto=format&fit=crop', alt: 'Desayunos' },
        { id: 'comidas', title: 'Comidas', imageUrl: 'https://images.unsplash.com/photo-1504674900247-0877df9cc836?q=80&w=2070&auto=format&fit=crop', alt: 'Comidas' },
        { id: 'cenas', title: 'Cenas', imageUrl: 'https://images.unsplash.com/photo-1515003197210-e0cd71810b5f?q=80&w=2070&auto=format&fit=crop', alt: 'Cenas' },
        { id: 'antojitos', title: 'Antojitos', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Comida6.jpeg', alt: 'Antojitos' },
        { id: 'postres', title: 'Postres', imageUrl: 'https://images.unsplash.com/photo-1563729784474-d77dbb933a9e?q=80&w=1974&auto=format&fit=crop', alt: 'Postres' },
        { id: 'bebidas', title: 'Bebidas', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Bebidas2.jpeg', alt: 'Bebidas' }
    ],
    menus: {
        desayunos: {
            bannerImage: 'https://file.garden/Z8NltLNFC1q_3W8R/desayunos_banner.jpg',
            items: [
                { id: 'd1', name: 'Chilaquiles Verdes', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Desayuno1.jpeg', description: 'Totopos de maíz bañados en salsa verde, con pollo, crema, queso y cebolla.', oldPrice: 180, currentPrice: 150 },
                { id: 'd2', name: 'Huevos Rancheros', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Desayuno2.jpeg', description: 'Dos huevos estrellados sobre tortillas de maíz, bañados en salsa roja picante.', oldPrice: 160, currentPrice: 140 },
                { id: 'd3', name: 'Enchiladas Suizas', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Desayuno3.jpeg', description: 'Tortillas rellenas de pollo, bañadas en una cremosa salsa verde y gratinadas con queso.', oldPrice: 190, currentPrice: 165 },
                { id: 'd4', name: 'Platillo Energético', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Desayuno4.jpeg', description: 'Perfecto para empezar el día con energía.', oldPrice: 160, currentPrice: 135 },
                { id: 'd5', name: 'Desayuno Sorpresa', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Desayuno5.jpeg', description: 'Deliciosa sorpresa del chef.', oldPrice: 150, currentPrice: 120 }
            ]
        },
        comidas: {
            bannerImage: 'https://file.garden/Z8NltLNFC1q_3W8R/comidas_banner.jpg',
            items: [
                { id: 'c1', name: 'Sopa de Tortilla', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Comida1.jpeg', description: 'Caldo de jitomate con tiras de tortilla frita, aguacate, queso y crema.', oldPrice: 120, currentPrice: 110 },
                { id: 'c2', name: 'Tacos al Pastor', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Comida2.jpeg', description: 'Carne de cerdo marinada en achiote, servidos con piña, cilantro y cebolla.', oldPrice: 150, currentPrice: 135 },
                { id: 'c3', name: 'Corte de Carne', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Comida3.jpeg', description: 'Jugoso corte de carne a la parrilla.', oldPrice: 300, currentPrice: 250 },
                { id: 'c4', name: 'Pasta Alfredo', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Comida4.jpeg', description: 'Pasta con cremosa salsa Alfredo.', oldPrice: 220, currentPrice: 190 },
                { id: 'c5', name: 'Hamburguesa Especial', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Comida5.jpeg', description: 'Hamburguesa con ingredientes de la casa.', oldPrice: 200, currentPrice: 170 },
                { id: 'c6', name: 'Ensalada César', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Comida6.jpeg', description: 'Clásica ensalada César con pollo.', oldPrice: 180, currentPrice: 150 },
                { id: 'c7', name: 'Pescado Frito', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Comida7.jpeg', description: 'Pescado del día, frito y crujiente.', oldPrice: 240, currentPrice: 200 },
                { id: 'c8', name: 'Pollo a la Naranja', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Comida8.jpeg', description: 'Pechuga de pollo en salsa de naranja.', oldPrice: 230, currentPrice: 195 },
                { id: 'c9', name: 'Pizza Margarita', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Comida9.jpeg', description: 'Pizza con salsa de tomate, mozzarella y albahaca.', oldPrice: 210, currentPrice: 180 }
            ]
        },
        cenas: {
            bannerImage: 'https://file.garden/Z8NltLNFC1q_3W8R/cenas_banner.jpg',
            items: [
                { id: 'ce1', name: 'Salmón a la Parrilla', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Cena1.jpeg', description: 'Filete de salmón fresco a la parrilla, servido con espárragos y puré de papa.', oldPrice: 280, currentPrice: 250 },
                { id: 'ce2', name: 'Filete Mignon', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Cena2.jpeg', description: 'Tierno filete de res en salsa de vino tinto.', oldPrice: 350, currentPrice: 300 }
            ]
        },
        antojitos: {
            bannerImage: 'https://file.garden/Z8NltLNFC1q_3W8R/AntojitosBanner.jpg',
            items: []
        },
        postres: {
            bannerImage: 'https://file.garden/Z8NltLNFC1q_3W8R/postres_banner.jpg',
            items: [
                { id: 'p1', name: 'Pastel de Chocolate', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Postres1.jpeg', description: 'Rebanada de nuestro famoso pastel de chocolate.', oldPrice: 120, currentPrice: 100 },
                { id: 'p2', name: 'Flan Napolitano', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Postres2.jpeg', description: 'Flan casero con caramelo.', oldPrice: 80, currentPrice: 70 },
                { id: 'p3', name: 'Tiramisú', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Postres3.jpeg', description: 'Postre italiano con café y queso mascarpone.', oldPrice: 110, currentPrice: 90 },
                { id: 'p4', name: 'Cheesecake de Fresa', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Postres4.jpeg', description: 'Cremoso cheesecake con mermelada de fresa.', oldPrice: 130, currentPrice: 110 },
                { id: 'p5', name: 'Helado Artesanal', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Postres5.jpeg', description: 'Dos bolas de helado de tu sabor preferido.', oldPrice: 90, currentPrice: 75 },
                { id: 'p6', name: 'Mousse de Maracuyá', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Postres6.jpeg', description: 'Ligero y refrescante mousse de fruta de la pasión.', oldPrice: 100, currentPrice: 85 },
                { id: 'p7', name: 'Crepas de Cajeta', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Postres7.jpeg', description: 'Rellenas de cajeta y cubiertas con nuez.', oldPrice: 120, currentPrice: 100 }
            ]
        },
        bebidas: {
            bannerImage: 'https://file.garden/Z8NltLNFC1q_3W8R/bebidas-refrescantes.jpg',
            items: [
                { id: 'b1', name: 'Margarita Clásica', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Bebidas1.jpeg', description: 'La margarita perfecta para acompañar tu comida.', oldPrice: 150, currentPrice: 120 },
                { id: 'b2', name: 'Mojito Cubano', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Bebidas2.jpeg', description: 'Refrescante mojito con ron, menta y limón.', oldPrice: 140, currentPrice: 110 },
                { id: 'b3', name: 'Limonada Fresca', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Bebidas3.jpeg', description: 'Limonada recién hecha, natural o mineral.', oldPrice: 70, currentPrice: 60 },
                { id: 'b4', name: 'Café Americano', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Bebidas4.jpeg', description: 'Café de grano recién molido.', oldPrice: 50, currentPrice: 40 },
                { id: 'b5', name: 'Té Helado', imageUrl: 'https://file.garden/Z8NltLNFC1q_3W8R/Bebidas5.jpeg', description: 'Té negro o verde, endulzado al gusto.', oldPrice: 60, currentPrice: 50 }
            ]
        }
    }
};
</script>
<script>
document.addEventListener('DOMContentLoaded', () => {
    const appState = {
        password: 'Xps600tj',
        isLoggedIn: false,
        data: null
    };

    const dom = {
        mainView: document.getElementById('main-view'),
        banner: document.getElementById('banner'),
        bannerTitle: document.getElementById('banner-title'),
        bannerSubtitle: document.getElementById('banner-subtitle'),
        bannerButton: document.getElementById('banner-button'),
        mainContentSubtitle: document.getElementById('main-content-subtitle'),
        mainContentTitle: document.getElementById('main-content-title'),
        gallery: document.getElementById('gallery'),
        adminFab: document.getElementById('admin-fab'),
        modalOverlay: document.getElementById('modal-overlay'),
        modalContainer: document.getElementById('modal-container'),
        loginView: document.getElementById('login-view'),
        adminPanelView: document.getElementById('admin-panel-view'),
        loginForm: document.getElementById('login-form'),
        passwordInput: document.getElementById('password'),
        loginMessage: document.getElementById('login-message'),
        logoutButton: document.getElementById('logout-button'),
        adminNavSite: document.getElementById('admin-nav-site'),
        adminNavMenus: document.getElementById('admin-nav-menus'),
        adminSiteSettingsView: document.getElementById('admin-site-settings-view'),
        adminMenusEditorView: document.getElementById('admin-menus-editor-view'),
        bannerForm: document.getElementById('banner-form'),
        mainContentForm: document.getElementById('main-content-form'),
        galleryFormsContainer: document.getElementById('gallery-forms-container'),
        addGalleryItemButton: document.getElementById('add-gallery-item-button'),
        categoryBannerForm: document.getElementById('category-banner-form'),
        menuCategorySelector: document.getElementById('menu-category-selector'),
        menuEditorItemsContainer: document.getElementById('menu-editor-items-container'),
        addMenuItemButton: document.getElementById('add-menu-item-button'),
    };

    function saveData() { localStorage.setItem('pageData', JSON.stringify(appState.data)); }
    function loadData() {
        try {
            const savedData = localStorage.getItem('pageData');
            appState.data = savedData ? JSON.parse(savedData) : siteData;
        } catch (e) {
            console.error("Error loading data from localStorage", e);
            appState.data = siteData;
        }
    }

    function renderPage() {
        const { banner, mainContent, gallery } = appState.data;
        dom.banner.style.backgroundImage = `url('${banner.imageUrl}')`;
        dom.bannerTitle.textContent = banner.title;
        dom.bannerSubtitle.textContent = banner.subtitle;
        dom.bannerButton.textContent = banner.buttonText;
        dom.bannerButton.href = 'https://wa.me/526645643104';
        dom.mainContentSubtitle.textContent = mainContent.subtitle;
        dom.mainContentTitle.textContent = mainContent.title;
        dom.gallery.innerHTML = '';
        gallery.forEach(item => {
            const link = document.createElement('a');
            link.href = `${item.id}.html`;
            link.className = 'gallery-item-container text-center';
            link.innerHTML = `<img src="${item.imageUrl}" alt="${item.alt}" class="gallery-image"><h3 class="gallery-title">${item.title}</h3>`;
            dom.gallery.appendChild(link);
        });
    }

    function renderAdminForms() {
        const { banner, mainContent, gallery } = appState.data;
        dom.bannerForm.elements.bannerTitle.value = banner.title;
        dom.bannerForm.elements.bannerSubtitle.value = banner.subtitle;
        dom.bannerForm.elements.bannerButtonText.value = banner.buttonText;
        dom.bannerForm.elements.bannerImageUrl.value = banner.imageUrl;
        dom.mainContentForm.elements.mainContentSubtitle.value = mainContent.subtitle;
        dom.mainContentForm.elements.mainContentTitle.value = mainContent.title;
        dom.galleryFormsContainer.innerHTML = '';
        gallery.forEach(item => {
            const form = document.createElement('form');
            form.dataset.id = item.id;
            form.className = 'p-4 border rounded space-y-2';
            form.innerHTML = `<label class="admin-label">Título (ID: ${item.id})</label><input type="text" name="title" value="${item.title}" class="admin-input"><label class="admin-label">URL de Imagen</label><input type="text" name="imageUrl" value="${item.imageUrl}" class="admin-input"><label class="admin-label">Texto Alternativo</label><input type="text" name="alt" value="${item.alt}" class="admin-input"><div class="flex space-x-2"><button type="submit" class="admin-button flex-grow">Guardar</button><button type="button" class="admin-button admin-button-delete delete-gallery-item">Eliminar</button></div>`;
            dom.galleryFormsContainer.appendChild(form);
        });
        dom.menuCategorySelector.innerHTML = '';
        appState.data.gallery.forEach(cat => {
            const option = document.createElement('option');
            option.value = cat.id;
            option.textContent = cat.title;
            dom.menuCategorySelector.appendChild(option);
        });
        if (dom.menuCategorySelector.value) {
            renderMenuEditor(dom.menuCategorySelector.value);
        }
    }

    function renderMenuEditor(category) {
        if (!appState.data.menus[category]) {
            appState.data.menus[category] = { bannerImage: '', items: [] };
        }
        dom.categoryBannerForm.elements.bannerImageUrl.value = appState.data.menus[category].bannerImage;
        dom.menuEditorItemsContainer.innerHTML = '';
        const items = appState.data.menus[category].items || [];
        items.forEach(item => {
            const form = document.createElement('form');
            form.dataset.id = item.id;
            form.dataset.category = category;
            form.className = 'p-4 border rounded space-y-2 bg-gray-50';
            form.innerHTML = `
                <div class="grid grid-cols-2 gap-x-4">
                    <div><label class="admin-label">Nombre</label><input type="text" name="name" value="${item.name}" class="admin-input"></div>
                    <div><label class="admin-label">URL de Imagen</label><input type="text" name="imageUrl" value="${item.imageUrl}" class="admin-input"></div>
                </div>
                <div><label class="admin-label">Descripción</label><textarea name="description" class="admin-input" rows="2">${item.description}</textarea></div>
                <div class="grid grid-cols-3 gap-x-4">
                    <div><label class="admin-label">Precio Anterior</label><input type="number" step="0.01" name="oldPrice" value="${item.oldPrice || ''}" class="admin-input"></div>
                    <div><label class="admin-label">Precio Actual</label><input type="number" step="0.01" name="currentPrice" value="${item.currentPrice}" class="admin-input"></div>
                    <div><label class="admin-label">ID</label><input type="text" name="id" value="${item.id}" class="admin-input" disabled></div>
                </div>
                <div class="flex space-x-2"><button type="submit" class="admin-button">Guardar Platillo</button><button type="button" class="admin-button admin-button-delete delete-menu-item">Eliminar</button></div>
            `;
            dom.menuEditorItemsContainer.appendChild(form);
        });
    }
    
    function showAdminView(view) {
        const isSiteView = view === 'site';
        dom.adminSiteSettingsView.style.display = isSiteView ? 'block' : 'none';
        dom.adminMenusEditorView.style.display = isSiteView ? 'none' : 'block';
        dom.adminNavSite.classList.toggle('active', isSiteView);
        dom.adminNavMenus.classList.toggle('active', !isSiteView);
    }

    function showModal(view) {
        dom.modalOverlay.style.display = 'flex';
        dom.loginView.style.display = view === 'login' ? 'block' : 'none';
        dom.adminPanelView.style.display = view === 'admin' ? 'block' : 'none';
    }

    function hideModal() {
        dom.modalOverlay.style.display = 'none';
        dom.passwordInput.value = '';
        dom.loginMessage.textContent = '';
    }

    // Event Listeners
    dom.adminFab.addEventListener('click', () => {
        if (appState.isLoggedIn) {
            renderAdminForms();
            showAdminView('site');
            showModal('admin');
        } else {
            showModal('login');
        }
    });

    dom.modalOverlay.addEventListener('click', e => { if (e.target === dom.modalOverlay) hideModal(); });

    dom.loginForm.addEventListener('submit', e => {
        e.preventDefault();
        if (dom.passwordInput.value === appState.password) {
            appState.isLoggedIn = true;
            renderAdminForms();
            showAdminView('site');
            showModal('admin');
        } else {
            dom.loginMessage.textContent = 'Contraseña incorrecta.';
        }
    });

    dom.logoutButton.addEventListener('click', () => { appState.isLoggedIn = false; hideModal(); });
    dom.adminNavSite.addEventListener('click', () => showAdminView('site'));
    dom.adminNavMenus.addEventListener('click', () => showAdminView('menus'));
    dom.menuCategorySelector.addEventListener('change', e => renderMenuEditor(e.target.value));

    dom.bannerForm.addEventListener('submit', e => {
        e.preventDefault();
        const fd = new FormData(e.target);
        appState.data.banner.title = fd.get('bannerTitle');
        appState.data.banner.subtitle = fd.get('bannerSubtitle');
        appState.data.banner.buttonText = fd.get('bannerButtonText');
        appState.data.banner.imageUrl = fd.get('bannerImageUrl');
        saveData(); renderPage(); alert('Banner actualizado.');
    });

    dom.mainContentForm.addEventListener('submit', e => {
        e.preventDefault();
        const fd = new FormData(e.target);
        appState.data.mainContent.subtitle = fd.get('mainContentSubtitle');
        appState.data.mainContent.title = fd.get('mainContentTitle');
        saveData(); renderPage(); alert('Título actualizado.');
    });

    dom.galleryFormsContainer.addEventListener('submit', e => {
        e.preventDefault();
        if (e.target.tagName !== 'FORM') return;
        const id = e.target.dataset.id;
        const fd = new FormData(e.target);
        const itemIndex = appState.data.gallery.findIndex(item => item.id === id);
        if (itemIndex > -1) {
            appState.data.gallery[itemIndex].title = fd.get('title');
            appState.data.gallery[itemIndex].imageUrl = fd.get('imageUrl');
            appState.data.gallery[itemIndex].alt = fd.get('alt');
            saveData(); renderPage(); renderAdminForms(); alert(`Categoría ${id} actualizada.`);
        }
    });

    dom.galleryFormsContainer.addEventListener('click', e => {
        if (e.target.classList.contains('delete-gallery-item')) {
            const form = e.target.closest('form');
            const id = form.dataset.id;
            if (confirm(`¿Seguro que quieres eliminar la categoría ${id}? Esto también eliminará su menú.`)) {
                appState.data.gallery = appState.data.gallery.filter(i => i.id !== id);
                delete appState.data.menus[id];
                saveData(); renderPage(); renderAdminForms();
            }
        }
    });

    dom.addGalleryItemButton.addEventListener('click', () => {
        const id = 'cat' + Date.now();
        appState.data.gallery.push({ id: id, title: 'Nueva Categoría', imageUrl: 'https://placehold.co/600x400/cccccc/ffffff?text=Nueva', alt: 'Nueva Categoría' });
        appState.data.menus[id] = { bannerImage: 'https://placehold.co/1200x600/cccccc/ffffff?text=Banner', items: [] };
        saveData(); renderPage(); renderAdminForms();
    });

    dom.categoryBannerForm.addEventListener('submit', e => {
        e.preventDefault();
        const category = dom.menuCategorySelector.value;
        appState.data.menus[category].bannerImage = e.target.elements.bannerImageUrl.value;
        saveData();
        alert(`Banner de ${category} actualizado.`);
    });

    dom.addMenuItemButton.addEventListener('click', () => {
        const category = dom.menuCategorySelector.value;
        if (!appState.data.menus[category]) {
            appState.data.menus[category] = { bannerImage: '', items: [] };
        }
        if (!appState.data.menus[category].items) {
            appState.data.menus[category].items = [];
        }
        const newItem = { id: 'i' + Date.now(), name: 'Nuevo Platillo', imageUrl: 'https://placehold.co/600x400/cccccc/ffffff?text=Platillo', description: 'Descripción...', oldPrice: 0, currentPrice: 0 };
        appState.data.menus[category].items.push(newItem);
        saveData(); renderMenuEditor(category);
    });

    dom.menuEditorItemsContainer.addEventListener('submit', e => {
        e.preventDefault();
        const form = e.target;
        const id = form.dataset.id;
        const category = form.dataset.category;
        const item = appState.data.menus[category].items.find(i => i.id === id);
        if (item) {
            const fd = new FormData(form);
            item.name = fd.get('name');
            item.imageUrl = fd.get('imageUrl');
            item.description = fd.get('description');
            item.oldPrice = parseFloat(fd.get('oldPrice')) || 0;
            item.currentPrice = parseFloat(fd.get('currentPrice'));
            saveData();
            alert('Platillo actualizado.');
        }
    });

    dom.menuEditorItemsContainer.addEventListener('click', e => {
        if (e.target.classList.contains('delete-menu-item')) {
            const form = e.target.closest('form');
            const id = form.dataset.id;
            const category = form.dataset.category;
            if (confirm('¿Eliminar este platillo?')) {
                appState.data.menus[category].items = appState.data.menus[category].items.filter(i => i.id !== id);
                saveData(); renderMenuEditor(category);
            }
        }
    });

    loadData();
    renderPage();
});
</script>
</body>
</html>
